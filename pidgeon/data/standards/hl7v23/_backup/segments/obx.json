{
  "segment": "OBX",
  "name": "Observation/Result",
  "description": "The OBX segment is used to transmit a single observation or observation fragment. It carries key clinical observation/results reporting information within report messages and is most commonly utilized in ORU (Observational Report â€“ Unsolicited) messages.",
  "standard": "hl7v23",
  "version": "2.3",
  "usage": "R",
  "cardinality": {
    "min": 0,
    "max": "*",
    "note": "Multiple OBX segments can follow an OBR to report individual test results"
  },
  "messageTypes": [
    "ORU^R01", "ORM^O01", "RDE^O01", "RDE^O11", "VXU^V04"
  ],
  "fields": {
    "OBX.1": {
      "name": "Set ID - OBX",
      "description": "This field contains the sequence number used to identify OBX segments for a given OBR segment. For the first occurrence, this will be 1; for the second occurrence, it will be 2; etc.",
      "dataType": "SI",
      "usage": "O",
      "maxLength": 4,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Sequential number starting from 1 for each OBR group"
    },
    "OBX.2": {
      "name": "Value Type",
      "description": "This field contains the format type of the observation value in OBX.5. The complete valid values are listed in HL7 Table 0125.",
      "dataType": "ID",
      "usage": "R",
      "maxLength": 2,
      "cardinality": {
        "min": 1,
        "max": 1
      },
      "validValues": [
        {"code": "AD", "description": "Address"},
        {"code": "CE", "description": "Coded Entry"},
        {"code": "CF", "description": "Coded Element with Formatted Values"},
        {"code": "CK", "description": "Composite ID with Check Digit"},
        {"code": "CN", "description": "Composite ID Number and Name"},
        {"code": "CP", "description": "Composite Price"},
        {"code": "CX", "description": "Extended Composite ID with Check Digit"},
        {"code": "DT", "description": "Date"},
        {"code": "FT", "description": "Formatted Text"},
        {"code": "NM", "description": "Numeric"},
        {"code": "PN", "description": "Person Name"},
        {"code": "RP", "description": "Reference Pointer"},
        {"code": "SN", "description": "Structured Numeric"},
        {"code": "ST", "description": "String Data"},
        {"code": "TM", "description": "Time"},
        {"code": "TN", "description": "Telephone Number"},
        {"code": "TS", "description": "Time Stamp"},
        {"code": "TX", "description": "Text Data"}
      ],
      "generationHint": "Most common: NM for numeric results, ST for text, CE for coded values"
    },
    "OBX.3": {
      "name": "Observation Identifier",
      "description": "This field contains a unique identifier for the observation. The format is that of the Coded Element (CE). When local codes are used, we strongly encourage sending a universal identifier (e.g., LOINC) as well.",
      "dataType": "CE",
      "usage": "R",
      "maxLength": 200,
      "cardinality": {
        "min": 1,
        "max": 1
      },
      "validValues": [
        {"code": "33747-0", "description": "Hemoglobin [Mass/volume] in Blood", "system": "LN"},
        {"code": "4544-3", "description": "Hematocrit [Volume Fraction] of Blood by Automated count", "system": "LN"},
        {"code": "6690-2", "description": "Leukocytes [#/volume] in Blood by Automated count", "system": "LN"},
        {"code": "777-3", "description": "Platelets [#/volume] in Blood by Automated count", "system": "LN"},
        {"code": "2093-3", "description": "Cholesterol [Mass/volume] in Serum or Plasma", "system": "LN"},
        {"code": "2571-8", "description": "Triglyceride [Mass/volume] in Serum or Plasma", "system": "LN"},
        {"code": "2345-7", "description": "Glucose [Mass/volume] in Serum or Plasma", "system": "LN"},
        {"code": "3094-0", "description": "Urea nitrogen [Mass/volume] in Serum or Plasma", "system": "LN"},
        {"code": "2160-0", "description": "Creatinine [Mass/volume] in Serum or Plasma", "system": "LN"}
      ],
      "generationHint": "Format: <local_code>^<local_text>^<coding_system>^<universal_code>^<universal_text>^<universal_system>"
    },
    "OBX.4": {
      "name": "Observation Sub-ID",
      "description": "This field is used to distinguish between multiple OBX segments with the same observation ID organized under one OBR. Used for battery results or repeated measurements.",
      "dataType": "ST",
      "usage": "O",
      "maxLength": 20,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Use when same test is repeated, e.g., '1', '2', '3' or 'PRE', 'POST'"
    },
    "OBX.5": {
      "name": "Observation Value",
      "description": "This field contains the value observed. The data type of this field is specified by OBX.2 Value Type. May contain numeric values, coded results, or text depending on the observation.",
      "dataType": "varies",
      "usage": "O",
      "maxLength": 65536,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Format depends on OBX.2: NM=numeric (12.5), ST=text (Normal), CE=coded (POS^Positive^HL70136)"
    },
    "OBX.6": {
      "name": "Units",
      "description": "This field contains the units of measurement for the value in OBX.5. Coding systems include UCUM, ISO+, ANSI X3.50-1986, and local coding systems.",
      "dataType": "CE",
      "usage": "O",
      "maxLength": 60,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "validValues": [
        {"code": "g/dL", "description": "grams per deciliter"},
        {"code": "mg/dL", "description": "milligrams per deciliter"},
        {"code": "mmol/L", "description": "millimoles per liter"},
        {"code": "mEq/L", "description": "milliequivalents per liter"},
        {"code": "10*3/uL", "description": "thousands per microliter"},
        {"code": "%", "description": "percent"},
        {"code": "U/L", "description": "units per liter"},
        {"code": "ng/mL", "description": "nanograms per milliliter"},
        {"code": "pg/mL", "description": "picograms per milliliter"}
      ],
      "generationHint": "Use standard units: g/dL for hemoglobin, mg/dL for glucose/cholesterol"
    },
    "OBX.7": {
      "name": "References Range",
      "description": "This field contains the reference (normal) range for the observation value. May be a range, single value, or text description.",
      "dataType": "ST",
      "usage": "O",
      "maxLength": 60,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Format examples: '12.0-15.5' (range), '<10' (upper limit), '>5.0' (lower limit)"
    },
    "OBX.8": {
      "name": "Abnormal Flags",
      "description": "This field contains a table lookup indicating the normalcy/abnormality of the result. Values from HL7 Table 0078.",
      "dataType": "ID",
      "usage": "O",
      "maxLength": 5,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "validValues": [
        {"code": "L", "description": "Below low normal"},
        {"code": "H", "description": "Above high normal"},
        {"code": "LL", "description": "Below lower panic limits"},
        {"code": "HH", "description": "Above upper panic limits"},
        {"code": "<", "description": "Below absolute low-off instrument scale"},
        {"code": ">", "description": "Above absolute high-off instrument scale"},
        {"code": "N", "description": "Normal"},
        {"code": "A", "description": "Abnormal"},
        {"code": "AA", "description": "Very abnormal"},
        {"code": "null", "description": "No range defined, or normal ranges don't apply"},
        {"code": "U", "description": "Significant change up"},
        {"code": "D", "description": "Significant change down"},
        {"code": "B", "description": "Better"},
        {"code": "W", "description": "Worse"}
      ],
      "generationHint": "Most common: N (normal), L/H (abnormal), LL/HH (critical)"
    },
    "OBX.9": {
      "name": "Probability",
      "description": "This field contains the probability that the observation is true (range 0 to 1). Used primarily in microbiology for organism identification confidence.",
      "dataType": "NM",
      "usage": "O",
      "maxLength": 5,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Usually empty except in microbiology (0.95 = 95% confidence)"
    },
    "OBX.10": {
      "name": "Nature of Abnormal Test",
      "description": "This field contains information about the nature of an abnormal test result. Values from HL7 Table 0080.",
      "dataType": "ID",
      "usage": "O",
      "maxLength": 2,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "validValues": [
        {"code": "A", "description": "An age-based population"},
        {"code": "N", "description": "None - generic normal range"},
        {"code": "R", "description": "A race-based population"},
        {"code": "S", "description": "A sex-based population"}
      ],
      "generationHint": "Usually empty or 'N' for standard reference ranges"
    },
    "OBX.11": {
      "name": "Observation Result Status",
      "description": "This field contains the observation result status indicating the current completion status of the results for one observation identifier. This is a required field.",
      "dataType": "ID",
      "usage": "R",
      "maxLength": 1,
      "cardinality": {
        "min": 1,
        "max": 1
      },
      "validValues": [
        {"code": "C", "description": "Record coming over is a correction and thus replaces a final result"},
        {"code": "D", "description": "Deletes the OBX record"},
        {"code": "F", "description": "Final results; Can only be changed with a corrected result"},
        {"code": "I", "description": "Specimen in lab; results pending"},
        {"code": "P", "description": "Preliminary results"},
        {"code": "R", "description": "Results entered -- not verified"},
        {"code": "S", "description": "Partial results"},
        {"code": "X", "description": "Results cannot be obtained for this observation"},
        {"code": "U", "description": "Results status change to final without retransmitting results already sent as 'preliminary'"},
        {"code": "W", "description": "Post original as wrong, e.g., transmitted for wrong patient"}
      ],
      "generationHint": "Most common: F (final), P (preliminary), I (in progress)"
    },
    "OBX.12": {
      "name": "Date/Time of the Observation",
      "description": "This field contains the date/time of the observation. If not present, the date/time of the OBR applies to the OBX.",
      "dataType": "TS",
      "usage": "O",
      "maxLength": 26,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Format: YYYYMMDDHHMMSS, usually same as or after OBR.7"
    },
    "OBX.13": {
      "name": "Producer's ID",
      "description": "This field identifies the producer of the observation. Usually contains information about the responsible laboratory or department.",
      "dataType": "CE",
      "usage": "O",
      "maxLength": 60,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Format: <dept_code>^<dept_name>, e.g., 'LAB^Clinical Laboratory'"
    },
    "OBX.14": {
      "name": "Responsible Observer",
      "description": "This field identifies the person responsible for the observation. Uses extended composite ID number and name format.",
      "dataType": "XCN",
      "usage": "O",
      "maxLength": 60,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "generationHint": "Format: <id>^<last_name>^<first_name>^<degree>, e.g., '67890^JONES^MARY^MD'"
    },
    "OBX.15": {
      "name": "Observation Method",
      "description": "This field identifies the method used to obtain the observation. Contains coded values describing the methodology or equipment used.",
      "dataType": "CE",
      "usage": "O",
      "maxLength": 60,
      "cardinality": {
        "min": 0,
        "max": 1
      },
      "validValues": [
        {"code": "AUTO", "description": "Automated method"},
        {"code": "MAN", "description": "Manual method"},
        {"code": "MICRO", "description": "Microscopy"},
        {"code": "CULTURE", "description": "Culture method"},
        {"code": "ELISA", "description": "Enzyme-linked immunosorbent assay"},
        {"code": "PCR", "description": "Polymerase chain reaction"},
        {"code": "SPEC", "description": "Spectrophotometry"}
      ],
      "generationHint": "Usually empty unless method is clinically significant"
    }
  },
  "crossReferences": {
    "fhir": [
      "Observation.code",
      "Observation.value",
      "Observation.referenceRange",
      "Observation.status"
    ],
    "related": ["OBR", "NTE"]
  },
  "generationRules": {
    "required": ["OBX.2", "OBX.3", "OBX.11"],
    "conditional": {
      "OBX.5": "Required if result value exists",
      "OBX.6": "Required if OBX.5 is numeric",
      "OBX.7": "Should be provided for numeric results"
    },
    "relationships": {
      "OBX.2_OBX.5": "Value type must match observation value format",
      "OBX.6_OBX.5": "Units only applicable for numeric or structured numeric values"
    },
    "validation": {
      "OBX.2": "Must be valid HL7 Table 0125 value",
      "OBX.8": "Must be valid HL7 Table 0078 value", 
      "OBX.11": "Must be valid HL7 Table 0085 value"
    }
  }
}